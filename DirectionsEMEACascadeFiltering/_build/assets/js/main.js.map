{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["\r\n\t\t\t$(function(){\r\n\r\n\t\t\t\tvar config = {\r\n\t\t\t\t\t\"name\":\"Directions EMEA 2017\", \r\n\t\t\t\t\t\"value\": \"nav2017emea\", \r\n\t\t\t\t\t\"id\":\"DEMEA2017\",\r\n\t\t\t\t\t\"apiKey\": \"27fb712f8df94818af9ba31ee2fd2783\",\r\n\t\t\t\t\t\"timeAdjust\": \"2\",\r\n\t\t\t\t\t\"conferencePath\": \"870c234b-cc83-44c7-abc4-7fb70a76c51e\",\r\n\t\t\t\t\t\"presentingPartner\": \"4404f28e-5b93-4da4-94d1-36fdf7d06597\",\r\n\t\t\t\t\t\"selectedFilters\" : [\"8a3b983a-3133-4589-bcf4-89616ffa2500\" , \"53fd7610-428b-461d-9a7f-876ca66d50ac\"] \r\n\t\t\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\t\t\t\tfunction Schedule(data , id) {   \r\n\t\t\t\t \r\n\t\t\t\t\tconsole.log(\"SCHEDULE DATA\" , data);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction fn_equal_heights(target) {\r\n\r\n\t\t\t\t\tvar heights = [];\r\n\r\n\t\t\t\t\t// the timeout function waits for the elements to be appended on the page , in order to get the correct height \r\n\t\t\t\t\t$.each(target , function(i , el){\r\n\t\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t\theights.push(el.clientHeight);\r\n\t\t\t\t\t\t} , 1000);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\tvar maxHeight = Math.max.apply(Math , heights);\r\n\t\t\t\t\t\t$.each(target , function(){\r\n\t\t\t\t\t\t\t$(this).css('height' , maxHeight + 'px');\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t// console.log(maxHeight);\r\n\t\t\t\t\t} , 1000);\t\t\r\n\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\tfunction buildFilterCategories(arr) {\r\n\t\t\t\t\t//console.log(arr);\r\n\r\n\t\t\t\t\tvar output = '';\r\n\t\t\t\t\t_.map(arr , function(obj){\r\n\t\t\t\t\t\t\toutput += '<li>' + '<a>' + obj.name + '  <span class=\"glyphicon glyphicon-plus\" style=\"position: absolute; padding: 1em; right: 5px;\"></span>' + '</a>';\r\n\t\t\t\t\t\t\toutput += '<ul>';\r\n\t\t\t\t\t\t\t_.map(obj.subcategories , function(o){\r\n\t\t\t\t\t\t\t\toutput += '<li class=\"filter-results\" id=\"'+ o.id +'\">' + o.name + '</li>';\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\toutput += '</ul>';\r\n\r\n\t\t\t\t\t\t\toutput += '</li>';\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\t$(\"#filterSessionsContainer\").append(output);\r\n\t\t\t\t}\r\n\r\n\r\n\r\n\t\t\t\tfunction handleFilterCategories(data) {\r\n\t\t\t\r\n\t\t\t\t\tvar firstLevel = _.reduce(data , function(result , value , key){\r\n\t\t\t\t\t\tif(value.parentid == \"\") {\r\n\t\t\t\t\t\t\tvar obj = {};\r\n\t\t\t\t\t\t\tobj.name = value.name;\r\n\t\t\t\t\t\t\tobj.id = value.id;\r\n\r\n\t\t\t\t\t\t  result.push(obj);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresult = result;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t} , []);\r\n\r\n\r\n\t\t\t\t\tvar categoriesFilter = _.reduce(firstLevel , function(result , value , key){\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\tvar arraySubcategories = _.filter(data , function(obj){\r\n\t\t\t\t\t\t\treturn obj.parentid == value.id;\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvalue.subcategories = arraySubcategories;\r\n\t\t\t\t\t\tresult.push(value);\r\n\t\t\t\t\t  return result;\r\n\r\n\t\t\t\t\t} , []);\r\n\r\n\r\n\t\t\t\t\tcategoriesFilter = _.filter(categoriesFilter , function(obj) {\r\n\t\t\t\t\t\tvar isFound = false;\r\n\r\n\t\t\t\t\t\t_.map(config.selectedFilters , function(val){\r\n\t\t\t\t\t\t\tif(obj.id == val) {\r\n\t\t\t\t\t\t\t\tisFound = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\treturn isFound;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// console.log(categoriesFilter);\r\n\t\t\t\t\tbuildFilterCategories(categoriesFilter);\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t\tfunction GetAPIData(link){\r\n\t\t\t\t  var deferred = $.Deferred();\r\n\t\t\t\t  $.ajax({\r\n\t\t\t\t    url: link,\r\n\t\t\t\t    type: 'GET',\r\n\t\t\t\t    dataType: 'jsonp'\r\n\t\t\t\t  })\r\n\t\t\t\t  .done(function(data){\r\n\t\t\t\t    deferred.resolve(data);\r\n\t\t\t\t  })\r\n\t\t\t\t  .fail(function(error) {\r\n\t\t\t\t    console.log(\"error API:\", link);\r\n\t\t\t\t    deferred.reject();\r\n\t\t\t\t  });\r\n\t\t\t\t  return deferred.promise();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction getData(event){\r\n\t\t\t\t  var deferred = $.Deferred();\r\n\t\t\t\t  var eventId = event.value;\r\n\t\t\t\t  var eventApi = event.apiKey;\r\n\t\t\t\t  var eventTimeAdjust = parseFloat(event.timeAdjust);\r\n\t\t\t\t  var daysUrl = 'http://api.eventpoint.com/2.3/program/days?code='+eventId+'&apikey=' + eventApi;\r\n\t\t\t\t  var topicsUrl = 'http://api.eventpoint.com/2.3/program/topics?code='+eventId+'&apikey=' + eventApi + '&pagesize=200&minpublishstatus=0';\r\n\t\t\t\t  var categoriesUrl = 'https://api.eventpoint.com/2.3/program/categories?code='+eventId+'&apikey=' + eventApi;\r\n\t\t\t\t  var roomsUrl = 'https://api.eventpoint.com/2.3/program/rooms?code='+eventId+'&apikey=' + eventApi;\r\n\t\t\t\t  var speakersUrl = 'https://api.eventpoint.com/2.3/program/speakers?code='+eventId+'&apikey=' + eventApi;\r\n\t\t\t\t\r\n\t\t\t\t  //console.log('event',event);\r\n\r\n\r\n\r\n\t\t\t\t  $.when(GetAPIData(daysUrl),GetAPIData(topicsUrl),GetAPIData(categoriesUrl),GetAPIData(roomsUrl),GetAPIData(speakersUrl)).then(function(v1,v2,v3,v4,v5){\r\n\t\t\t\t    // var conferencePathArray = conferenceArray(v3, event);    \r\n\t\t\t\t    // console.log(\"days\",v1);\r\n\t\t\t\t    console.log(\"topics\",v2);\r\n\t\t\t\t    handleFilterCategories(v3);\r\n\t\t\t\t    // console.log(\"categories\",v3);\r\n\t\t\t\t    // console.log(\"rooms\",v4);\r\n\t\t\t\t    // console.log(\"speakers\",v5);    \r\n\t\t\t\t    var scheduleData = _.reduce(v1, function(result, value, key){\r\n\t\t\t\t      var date = value.date;\r\n\t\t\t\t      // date = date.split('T')[0];\r\n\t\t\t\t      date = moment(date).format(\"YYYY-MM-DD\");\r\n\r\n\t\t\t\t      var obj = {};\r\n\t\t\t\t      obj.date = date;\r\n\t\t\t\t      obj.topics = _.chain(v2.results)\r\n\t\t\t\t      .filter(function(o){\r\n\t\t\t\t        var dateAdjusted = \"\";\r\n\t\t\t\t        dateAdjusted = moment(o.start).utcOffset(eventTimeAdjust).format(\"YYYY-MM-DD\");\r\n\t\t\t\t        return dateAdjusted == date;\r\n\t\t\t\t      })\r\n\t\t\t\t      .reduce(function(result, value, key){\r\n\t\t\t\t        var obj = {};\r\n\t\t\t\t        var roomsArray = _.chain(v4)\r\n\t\t\t\t                          .filter(function(o){\r\n\t\t\t\t                              return o.name == value.room;\r\n\t\t\t\t                          })\r\n\t\t\t\t                          .uniqBy(\"id\")\r\n\t\t\t\t                          .value();\r\n\t\t\t\t        // var partnerId = getPartnerId(v3);\r\n\t\t\t\t        var partnerId = event.presentingPartner;\r\n\t\t\t\t                 \r\n\t\t\t\t        // console.log(\"SPEAKERS IDS \" , speakersArray);\r\n\t\t\t\t        // console.log(\"PARTNER ID: \" , partnerId);\r\n\r\n\t\t\t\t        obj.title = value.title;\r\n\t\t\t\t        obj.speakers = _.reduce(value.speakerids , function(result , value , key){\r\n\t\t\t\t          var obj = {};\r\n\t\t\t\t          var speakersName = _.filter(v5.results , function(o){\r\n\t\t\t\t            return o.id == value;\r\n\t\t\t\t          });\r\n\r\n\t\t\t\t          if(_.size(speakersName) > 0) {\r\n\t\t\t\t            obj.name = speakersName[0].name;\r\n\t\t\t\t          } else {\r\n\t\t\t\t            obj.name = null;\r\n\t\t\t\t          }\r\n\r\n\t\t\t\t          obj.id = value;\r\n\t\t\t\t          result.push(obj);\r\n\t\t\t\t          return result;\r\n\t\t\t\t        },[]);\r\n\t\t\t\t        obj.room = {};\r\n\t\t\t\t        obj.room.capacity = 0; //backup api\r\n\t\t\t\t        obj.room.id = undefined; //backup api\r\n\t\t\t\t        // console.log(\"roomsArray[0]\", roomsArray )\r\n\t\t\t\t        // console.log(\"roomsArray[0] size \", _.size(roomsArray) )\r\n\t\t\t\t        // console.log(\"rooms v4\", v4)\r\n\t\t\t\t        // console.log(\"current Value\", value)\r\n\r\n\t\t\t\t        if (_.size(roomsArray) !== 0) {          \r\n\t\t\t\t          obj.room.capacity = roomsArray[0].capacity;  // verification added because US 2017 does not have a room name set to a topic and capacity property cant be found\r\n\t\t\t\t        }\r\n\t\t\t\t        obj.id = value.id;\r\n\t\t\t\t        obj.sessionCode = value.code;\r\n\t\t\t\t        obj.description = value.description;\r\n\t\t\t\t        obj.publishingStatus = value.publishingstatus;\r\n\t\t\t\t        \r\n\t\t\t\t        obj.room.title = value.room;\r\n\t\t\t\t        \r\n\t\t\t\t        if (_.size(roomsArray) !== 0) {    \r\n\t\t\t\t          obj.room.id = roomsArray[0].id;\r\n\t\t\t\t        }\r\n\t\t\t\t        obj.categoryids = value.categoryids;\r\n\t\t\t\t        obj.start = moment(value.start).utcOffset(eventTimeAdjust).format(\"HH:mm\");\r\n\t\t\t\t        obj.finish = moment(value.finish).utcOffset(eventTimeAdjust).format(\"HH:mm\");\r\n\t\t\t\t                      // console.log(\"timeadjust\", Math.abs(eventTimeAdjust), \"times:\",obj.start, \"timesoriginal\", value.start);\r\n\r\n\t\t\t\t        // obj.conferencePath = _.filter(conferencePathArray, function(object){\r\n\t\t\t\t        //   return _.includes(value.categoryids, object.id)\r\n\t\t\t\t        // });\r\n\r\n\t\t\t\t        var isPartner = _.includes(value.categoryids, partnerId);         \r\n\t\t\t\t        if(isPartner === true) {\r\n\t\t\t\t          obj.isPartner = true;\r\n\t\t\t\t        } else {\r\n\t\t\t\t          obj.isPartner = false;\r\n\t\t\t\t        }\r\n\t\t\t\t        result.push(obj);\r\n\t\t\t\t        return result;\r\n\r\n\t\t\t\t        },[])\r\n\t\t\t\t      .sortBy(\"start\")\r\n\t\t\t\t      .value();\r\n\t\t\t\t      result.push(obj);\r\n\t\t\t\t      return result;\r\n\t\t\t\t    },[]);\r\n\r\n\r\n\t\t\t\t    // $(\"#schedule\").empty().removeClass(\"animated fadeOut\"); // CLEARS SCHEDULE TABLE\r\n\t\t\t\t    deferred.resolve(scheduleData);\r\n\t\t\t\t  },function() {\r\n\t\t\t\t    //error getting API => select again\r\n\t\t\t\t    // resetWhenDataIsInvalid();\r\n\t\t\t\t    deferred.reject();\r\n\r\n\t\t\t\t  });\r\n\t\t\t\t  return deferred.promise();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfunction buildSchedule(dataset) {\r\n\t\t\t\t\t// console.log(dataset);\t\t\t\t\t\r\n\r\n\t\t\t\t\tvar output = '';\r\n\r\n\t\t\t\t\t$(\"#showSessions\").empty();\r\n\t\t\t\t\tif(_.size(dataset) > 0) {\r\n\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t\t_.map(dataset , function(day){\r\n\r\n\t\t\t\t\t\t\r\n\r\n\r\n\t\t\t\t\t\t\t\tif(day.topics.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\toutput += '<div class=\"col-md-12\">';\r\n\t\t\t\t\t\t\t\t\t\toutput += '<p style=\"text-align: center; padding-top: 0.5em\">' + day.date + '</p>';\r\n\r\n\t\t\t\t\t\t\t\t\t\t_.map(day.topics , function(o){\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar title = o.title;\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar start = o.start;\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar finish = o.finish;\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar room = o.room.title;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\toutput += '<div class=\"sessionWrapper\" style=\"border: 2px solid black; padding: 0.5em; margin-bottom: 0.5em; font-size: 12px\">';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\toutput += '<p style=\"border-bottom: 1px solid red; padding-bottom: 0.5em\">' + title + '</p>';\r\n\t\t\t\t\t\t\t\t\t\t\t\toutput += '<p>' + \"Room: \" + room + '</p>';\r\n\t\t\t\t\t\t\t\t\t\t\t\toutput += '<p>' + \"Start: \" + start + \" End: \" + finish + '</p>';\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\toutput += '</div>';\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\toutput += '</div>';\r\n\t\t\t\t\t\t\t\t} \r\n\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t\t} \r\n\r\n\t\t\t\t\t$(\"#showSessions\").append(output);\r\n\t\t\t\t\t\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$.when(getData(config)).then(function(data){\r\n\r\n\t\t\t\t \r\n\r\n\t\t\t\t  var dataSet = data;\r\n\t\t\t\t  console.log(\"dataset\",dataSet);\r\n\t\t\t\t  // array in which we store the filters\r\n\t\t\t\t  var arrayOfFilters = [];\r\n\r\n\t\t\t\t  // show all sessions by default\r\n\t\t\t\t  buildSchedule(dataSet);\r\n\r\n\t\t\t\t  // get cookies \r\n\t\t\t\t  getCookiesData();\r\n\r\n\t\t\t\t  // click handler for first level categories \r\n\t\t\t\t  $(\"#filterSessionsContainer a\").on(\"click\" , function(e){\r\n\t\t\t\t  \t\tvar options = $(this).next(); // grab the ul\r\n\r\n\t\t\t\t  \t\toptions.toggle(\"slow\");\r\n\r\n\t\t\t\t  \t\t$(this).find(\"span\").toggleClass(\"glyphicon glyphicon-plus glyphicon glyphicon-minus\");\r\n\t\t\t\t  });\r\n\r\n\r\n\t\t\t\t  // click handler for filtering options\r\n\t\t\t\t  $(\"body\").on(\"click\" , \".filter-results\", function(e){\r\n\t\t\t\t \r\n\t\t\t\t  \t\tvar filterId = $(this).attr(\"id\");\r\n\t\t\t\t  \t\tvar text = $(this).text();\r\n\r\n\t\t\t\r\n\r\n\t\t\t\t  \t\taddToSelectedFilters(filterId , text);\r\n\r\n\t\t\t\t  \t\t// console.log(arrayOfFilters);\r\n\r\n\t\t\t\t  \t\tvar finalOutputWithFilters = _.reduce(arrayOfFilters , function(result , value , key){\r\n\t\t\t\t  \t\t\t\r\n\r\n\t\t\t\t  \t\t\tif(key == 0) {\r\n\t\t\t\t  \t\t\t\tresult = setOutputForFilters(dataSet , value.id);\r\n\t\t\t\t  \t\t\t} else {\r\n\t\t\t\t  \t\t\t\tresult = setOutputForFilters(result , value.id);\r\n\t\t\t\t  \t\t\t}\r\n\r\n\r\n\t\t\t\t  \t\t\treturn result;\r\n\t\t\t\t  \t\t} , []);\r\n\r\n\t\t\t\t  \t\t// console.warn(finalOutputWithFilters);\r\n\r\n\t\t\t\t  \t\r\n\t\t\t\t  \t\tbuildSchedule(finalOutputWithFilters);\r\n\r\n\t\t\t\t  });\r\n\r\n\t\t\t\t  // remove from selected filters on click\r\n\t\t\t\t  $(\"body\").on(\"click\" , \".applied-filter > span\" , function(e){\r\n\r\n\t\t\t\t  \t\tvar idOfLi = $(this).parent().attr(\"id\");\r\n\t\t\t\t  \t\tvar textOfLi = $(this).parent().text();\r\n\r\n\t\t\t\t  \t\t_.remove(arrayOfFilters , function(arg){\r\n\t\t\t\t  \t\t\treturn arg.id == idOfLi;\r\n\t\t\t\t  \t\t});\r\n\r\n\t\t\t\t  \t\tremoveToSelectedFilters(idOfLi , textOfLi);\r\n\r\n\t\t\t\t  \t\trenderSelectedFilters(arrayOfFilters);\r\n\r\n\r\n\t\t\t\t  \t\t// show remove all filters button if the length of the filters is greater than 0 \r\n\t\t\t\t  \t\tif($(\"#selectedSessions\").find(\"ul\").children().length == 0) {\r\n\t\t\t\t  \t\t\t$(\"#removeFilters\").css(\"display\" , \"none\");\r\n\r\n\r\n\t\t\t\t  \t\t\t// empty the sessions wrapper\r\n\t\t\t\t  \t\t\t$(\"#showSessions\").empty();\r\n\r\n\t\t\t\t  \t\t\t// show all sessions\r\n\t\t\t\t  \t\t\tbuildSchedule(dataSet);\r\n\r\n\r\n\t\t\t\t  \t\t} else {\r\n\t\t\t\t  \t\t\t$(\"#removeFilters\").css(\"display\" , \"block\");\r\n\t\t\t\t  \t\t}\r\n\r\n\t\t\t\t  });\r\n\r\n\r\n\t\t\t\t  $(\"body\").on(\"click\" , \"#removeFilters\" , function(e){\r\n\t\t\t\t  \t\tconsole.log(\"Remove all filters...\");\r\n\t\t\t\t  \t\tarrayOfFilters = [];\r\n\t\t\t\t  \t\trenderSelectedFilters(arrayOfFilters);\r\n\t\t\t\t  \t\t$(\"#removeFilters\").css(\"display\" , \"none\");\r\n\r\n\t\t\t\t  \t\t// empty the sessions wrapper\r\n\t\t\t\t  \t\t$(\"#showSessions\").empty();\r\n\r\n\t\t\t\t  \t\t// show all sessions\r\n\t\t\t\t  \t\tbuildSchedule(dataSet);\r\n\r\n\r\n\t\t\t\t  \t\tCookies.set(\"filtered\" , \"[]\");\r\n\r\n\r\n\t\t\t\t  });\r\n\r\n\r\n\t  \t\t\t  function setOutputForFilters(dataSet , filterId) {\r\n\r\n\t    \t\t\t  \t\tvar filtered_days = _.reduce(dataSet , function(result , value , key) {\r\n\t    \t\t\t  \t\t\t\tvar obj = {};\r\n\t    \t\t\t  \t\t\t\tobj.date = value.date;\r\n\r\n\t    \t\t\t  \t\t\t\tvar filtered_topics = _.reduce(value.topics , function(result2 , value2 , key2) {\r\n\t    \t\t\t  \t\t\t\t\t\tvar category_matched = _.filter(value2.categoryids , function(val) {\r\n\t    \t\t\t  \t\t\t\t\t\t\t\tvar isFound = false;\r\n\r\n\t    \t\t\t  \t\t\t\t\t\t\t\t// _.map(arrayOfFilters , function(_obj) {\r\n\t    \t\t\t  \t\t\t\t\t\t\t\t// \t\tif(_obj.id == val) {\r\n\t    \t\t\t  \t\t\t\t\t\t\t\t// \t\t\t\tisFound = true;\r\n\t    \t\t\t  \t\t\t\t\t\t\t\t// \t\t}\r\n\t    \t\t\t  \t\t\t\t\t\t\t\t// });\r\n\r\n\t    \t\t\t  \t\t\t\t\t\t\t\tif(filterId == val) {\r\n\t    \t\t\t  \t\t\t\t\t\t\t\t\tisFound = true;\r\n\t    \t\t\t  \t\t\t\t\t\t\t\t}\r\n\r\n\t    \t\t\t  \t\t\t\t\t\t\t\r\n\t    \t\t\t  \t\t\t\t\t\t\t\treturn isFound;\r\n\t    \t\t\t  \t\t\t\t\t\t});\r\n\r\n\t    \t\t\t\t\t  \t\t\t\tif(_.size(category_matched) > 0) {\r\n\t    \t\t\t  \t\t\t\t\t\t\tresult2.push(value2);\r\n\t    \t\t\t  \t\t\t\t\t\t} else {\r\n\t    \t\t\t  \t\t\t\t\t\t\tresult2 = result2;\r\n\t    \t\t\t  \t\t\t\t\t\t} \t\t\r\n\r\n\t    \t  \t\t\t\t\t\t\t\treturn result2;\r\n\t    \t\t\t  \t\t\t\t} , []);\r\n\r\n\r\n\t    \t\t\t  \t\t\t\tobj.topics = filtered_topics;\r\n\r\n\t    \t\t\t  \t\t\t\tresult.push(obj);\r\n\r\n\t    \t\t\t  \t\t\t\treturn result;\r\n\t    \t\t\t  \t\t} , []);\r\n\r\n\r\n\t    \t\t\t  \t\treturn filtered_days;\r\n\r\n\t  \r\n\t  \t\t\t  }\r\n\r\n\t\t\t\t  function renderSelectedFilters(arr) {\r\n\t\t\t\t  \t$(\"#selectedSessions\").empty();\r\n\t\t\t\t  \tvar output = '';\r\n\r\n\t\t\t\t  \toutput += '<button id=\"removeFilters\" style=\"margin:0em 0em 1em 3em; border-radius: 0px; border-color: black\" class=\"btn btn-default\">Remove filters</button>';\r\n\t\t\t\t  \toutput += '<ul>';\r\n\r\n\t\t\t\t  \t_.map(arr , function(o){\r\n\t\t\t\t  \t\toutput += '<li class=\"applied-filter\" id=\"'+ o.id +'\">' + o.name + ' <span class=\"glyphicon glyphicon-remove\"></span>' + '</li>';\r\n\t\t\t\t  \t});\r\n\r\n\t\t\t\t  \toutput += '</ul>';\r\n\r\n\r\n\t\t\t\t  \t$(\"#selectedSessions\").append(output);\r\n\r\n\r\n\t\t\t\t  }\r\n\r\n\t\t\t\t  function removeToSelectedFilters(id , text) {\r\n\r\n\t\t\t\t  \tvar finalOutputWithFilters = _.reduce(arrayOfFilters , function(result , value , key){\r\n\r\n\t\t\t\t  \t\tif(key == 0) {\r\n\t\t\t\t  \t\t\tresult = setOutputForFilters(dataSet , value.id);\r\n\t\t\t\t  \t\t} else {\r\n\t\t\t\t  \t\t\tresult = setOutputForFilters(result , value.id);\r\n\t\t\t\t  \t\t}\r\n\r\n\r\n\t\t\t\t  \t\treturn result;\r\n\t\t\t\t  \t} , []);\r\n\r\n\t\t\t\t  \t// console.warn(finalOutputWithFilters);\r\n\r\n\t\t\t \t\trenderSelectedFilters(arrayOfFilters);\r\n\t\t\t  \t\tremoveFilterFromCookie(id);\r\n\r\n\t\t\t  \t\tbuildSchedule(finalOutputWithFilters);\r\n\t\t\t\t  }\r\n\r\n\r\n\r\n\t\t\t\t  function getCookiesData() {\r\n\t\t\t\t  \tvar cookiesData = Cookies.get(\"filtered\");\r\n\r\n\t\t\t\t  \t\r\n\r\n\t\t\t\t  \tif(cookiesData !== undefined) {\r\n\t\t\t\t  \t\tvar cookies = $.parseJSON(cookiesData);\r\n\t\t\t\t  \t\tarrayOfFilters = cookies;\r\n\t\t\t\t  \t}\r\n\r\n\t\t\t\t  \t// console.warn(arrayOfFilters);\r\n\r\n\r\n\t\t\t\t  \tvar finalOutputWithFilters = _.reduce(arrayOfFilters , function(result , value , key){\r\n\t\t\t\t  \t\t\r\n\r\n\t\t\t\t  \t\tif(key == 0) {\r\n\t\t\t\t  \t\t\tresult = setOutputForFilters(dataSet , value.id);\r\n\t\t\t\t  \t\t} else {\r\n\t\t\t\t  \t\t\tresult = setOutputForFilters(result , value.id);\r\n\t\t\t\t  \t\t}\r\n\r\n\r\n\t\t\t\t  \t\treturn result;\r\n\t\t\t\t  \t} , []);\r\n\r\n\t\t\t\t  \t// console.warn(finalOutputWithFilters);\r\n\r\n\t\t\t\t  \tconsole.log(arrayOfFilters);\r\n\r\n\t\t\t\t  \tif(_.size(arrayOfFilters) > 0) {\r\n\t\t\t\t  \t\tbuildSchedule(finalOutputWithFilters);\r\n\t\t\t\t  \t} else {\r\n\t\t\t\t  \t\tbuildSchedule(dataSet);\r\n\t\t\t\t  \t}\r\n\r\n\t\t\t\t  \t\r\n\t\t\t\t  \t\r\n\t\t\t\t  \trenderSelectedFilters(arrayOfFilters);\r\n\t\t\t\t  }\r\n\r\n\t\t\t\t  function addFilterToCookie(arr) {\r\n\r\n\t\t\t\t\t\tvar arrString = JSON.stringify(arr);\r\n\t\t\t\t\t\tCookies.set(\"filtered\" , arrString , 1);\r\n\r\n\t\t\t\t  }\r\n\r\n\r\n\t\t\t\t  function removeFilterFromCookie(filterId) {\r\n\t\t\t\t  \t\t// console.log(filterId);\r\n\r\n\t\t\t\t  \t\t// var cookie = Cookies.get(\"filtered\") === undefined ? \"[]\" : cookie;\r\n\r\n\t\t\t\t  \t\tvar cookie = Cookies.get(\"filtered\");\r\n\r\n\t\t\t\t  \t\tif(cookie !== undefined) {\r\n\r\n\t\t\t\t  \t\t\tvar removeCookie = $.parseJSON(cookie);\r\n\r\n\t\t\t\t  \t\t\tremoveCookie = _.filter(removeCookie , function(o){\r\n\t\t\t\t  \t\t\t\treturn o.id != filterId;\r\n\t\t\t\t  \t\t\t});\r\n\r\n\r\n\t\t\t\t  \t\t\taddFilterToCookie(removeCookie);\r\n\t\t\t\t  \t\t\t// renderSelectedFilters(removeCookie);\r\n\t\t\t\t  \t\t\tgetCookiesData();\r\n\t\t\t\t  \t\t\t\r\n\t\t\t\t  \t\t\t// console.log(removeCookie);\r\n\r\n\t\t\t\t  \t\t\tremoveCookie = JSON.stringify(removeCookie);\r\n\r\n\t\t\t\t  \t\t}\r\n\t\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  }\r\n\r\n\t\t\t\t  function addToSelectedFilters(id , text) {\r\n\t\t\t\t  \tvar target = $(\"#selectedSessions\").find(\"ul\");\r\n\r\n\r\n\r\n\r\n\t\t\t\t  \tvar object = {};\r\n\t\t\t\t  \tobject.id = id;\r\n\t\t\t\t  \tobject.name = text;\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t\t  \tvar isThere = _.filter(arrayOfFilters , function(o){\r\n\t\t\t\t  \t\treturn o.id == object.id;\r\n\t\t\t\t  \t});\r\n\r\n\t\t\t\t  \tvar isInArray = _.size(isThere) ? true : false;\r\n\r\n\t\t\t\t  \tif(!isInArray) {\r\n\t\t\t\t  \t\tarrayOfFilters.push(object);\r\n\t\t\t\t  \t\taddFilterToCookie(arrayOfFilters);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t} else {\r\n\t\t\t\t  \t\talert(\"The filter is already applied!\");\r\n\t\t\t\t  \t\treturn;\r\n\t\t\t\t  \t}\r\n\r\n\r\n\t\t\t\t  \t// console.log(arrayOfFilters);\r\n\r\n\t\t\t\t  \trenderSelectedFilters(arrayOfFilters);\r\n\r\n\t\t\t\t  }\r\n\r\n\r\n\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t});\r\n\r\n\r\n"]}